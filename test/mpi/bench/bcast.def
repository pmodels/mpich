include: macros/bench_frame.def
include: macros/bench_coll.def
include: macros/mtest.def

page: bcast, bench_frame
    data: buf, size, MPI_CHAR
    NEED_ROOT: 1

    $(if:0)
        &call measure_with_barrier
            MPI_Bcast($(data), root, comm)
    $(else)
        $call bench_coll, measure_bcast

fncode: measure_bcast(int iter, int root, comm, size, pf_min, pf_max, pf_avg, pf_sigma)
    &call measure_coll_latency, iter
        void *buf = (char *) gbuf + i * size % (MAX_BUFSIZE - size)
        MPI_Bcast($(data), root, comm)
    $(for:min,max,avg,sigma)
        *pf_$1 = tf_$1

